---
title: "Counter Strike 2"
subtitle: "A simple Analysis of E-sports Data"
author: "Alvaro Cervan"
subject: "Sports Data Analysis"
date: last-modified
title-block-banner: orange
title-block-banner-color: black
toc: true
toc-location: left
toc-depth: 4
number-sections: true
number-sections-depth: 3
format:
  html:
    code-fold: true
    theme: darkly 
  pdf: default
jupyter: python3
---

# TODO
- How are tournaments structured? (who plays against who)

## Introduction

This is a simple analysis of Counter Strike 2 data. The data was obtained from [Kaggle](https://www.kaggle.com/). The data includes information about weapons, players, maps, professional players, and professional games.

::: {.callout-note}
In September 27, 2023 Counter Strike 2 (CS2) was released. The previous version, Counter Strike Global Offensive (CSGO), was released in August 21, 2012. They are essentially the same game, but CS2 has newer graphics and a few new features and improvements.
:::

### What is Counter Strike 2?

![Counter Strike 2 logo](resources/csgo%20logo.jpg)

<details>
<summary>Display information about the game</summary>

#### The Game 

Counter-Strike 2 is a first-person shooter video game developed by Valve Corporation. It is the fourth game in the Counter-Strike series. 
In 2012, with the release of Counter-Strike: Global Offensive, the game became hugely popular largely due to the **competitive mode** and the introduction of **skins (gambling related)**.

The game pits two teams against each other: the **Terrorist (T)** against the **Counter Terrorist (CT)**. Each team has 5 players, with a total of 10 players in a match. At the start, the teams are given the roles of T or CT. In the round 13 this roles are swapped.

#### The Rules

A competitive match of CS2 is played in a maximum of 24 **rounds of 2 minutes**. 

- **The winner:** First team to win 13 rounds wins the match.
- **Tie:** It is possible to end the match in a Tie if both teams reach 12 rounds.
- **Surrender:** If a team mate leaves of the match is very unequal and a team see that losing is unavoidable, they can vote to surrender to save time.

#### The Round

Each round is started in the same way. Both teams player's appear in their base, and have 15 seconds before they can move and start the round to prepare and choose their equipment.

To win a round there are 2 possible ways:

- Kill all (5) players on the other team.
- **Terrorists:** Plant the bomb and explode it.
- **Counter Terrorist:** Defuse the bomb after is set.

#### Map

Every map is designed in a similar way. The CT appear near the designated areas where the bomb must be planted. The T appears in the opposite end of the map. The maps then have different paths and features, but in general they have 3 main paths to reach the bomb site: A, B and Middle.

- **A:** The path that leads to bomb site "A".
- **B:** The path that leads to bomb site "B".
- **Middle:** The path that leads to the middle of the map. It is usually more dangerous and leads between the two bomb sites.

![Mirage Map with Callouts](resources/de_mirage-map-callouts.jpg){#fig-map}


</details>

### Why Counter Strike 2?

<details>

<summary> Why CS2 is different from other Esports </summary>

Counter Strike 2 might look simple on a first impression, but under the hood, it is a very complex game, with a huge amount of systems to keep in mind that can tilt the game in favour of the most prepared team.

#### Money

Money is a key element of CS2, as it is used to buy weapons, armor, and grenades. Managing money is crucial to winning the game, as it can give a team a significant advantage over the other team. The amount of money a team has will determine what weapons they can buy, and how many grenades they can afford.

At the beginning of each round, each team member is awarded an amount of money. The amount will differ depending on the outcome of the previous round. Furthermore, if a team wins a round, they will receive more money than the losing team, but to keep the game balanced, the losing team will receive a higher amount of money the more rounds they lose in a row.

Also, bonus money is awarded for completing objectives, such as planting the bomb, defusing the bomb, or killing the enemy team.

Killing an enemy player will also reward the player with money, but the amount will depend on the weapon used to kill the enemy.

#### Weapons

There are a variety of weapons in CS2, each with its own unique characteristics. Some weapons are more powerful than others, but they are also more expensive. The most powerful weapons are the AWP and the AK-47, but they are also the most expensive. The AWP is a one-shot kill weapon, while the AK-47 is a one-shot kill weapon to the head.

Generally, the weapons can be divided into three categories: 

| Category | Description                                                                 |
|----------|-----------------------------------------------------------------------------|
| Rifles   | Rifles are the most powerful weapons, but they are also the most expensive. |
| SMGs     | SMGs are less powerful than rifles, but they are also less expensive.       |
| Pistols  | Pistols are the least powerful weapons, but they are also the least expensive. |

::: {.callout-note}
As the CT team starts with the advantage of defending the bomb sites, they have more expensive weapons. The T team, on the other hand, has to attack the bomb sites, so they have cheaper weapons.
:::

#### Grenades and Armor

##### Armor
Armor is an essential part of CS2, as it can protect the player from damage. There are two types of armor in CS2:

| Armor  | Description                                      |
|--------|--------------------------------------------------|
| Kevlar | Protects the player from damage to the body. Raises armor to 100     |
| Helmet | Protects the player from damage to the head.      |

Armor can be bought at the beginning of each round, and it will protect the player from damage until it is depleted. Once the armor is depleted, the player will take full damage from any subsequent hits.

The helmet is an optional purchase after buying Kevlar. It is recommended to buy a helmet if the enemy team is using rifles, as it will protect the player from a one-shot kill to the head.

##### Grenades
Grenades are an essential part of CS2, as they can be used to control the map and force the enemy team to move. There are five types of grenades in CS2:

| Grenade              | Description                                             |
|----------------------|---------------------------------------------------------|
| Flashbang            | A grenade that blinds the enemy team.                   |
| Smoke                | A grenade that creates a smoke screen.                  |
| HE                   | A grenade that deals damage to the enemy team.          |
| Molotov / Incendiary | A grenade that creates a fire that deals damage to the enemy team. |
| Decoy                | A grenade that creates a fake gunfire sound.            |

#### Strategy

CS2 is a game of strategy and teamwork. A team that works together and communicates effectively will have a significant advantage over a team that does not. There are many strategies that can be used in CS2, such as:

| Strategy| Description|
|---|-----------------|
| Rushing                | A strategy where the team quickly moves to a bomb site to catch the enemy team off guard. |
| Splitting              | A strategy where the team splits up and attacks multiple bomb sites at once. |
| Holding                | A strategy where the team holds a position and waits for the enemy team to come to them. |
| Faking                 | A strategy where the team pretends to attack one bomb site, but then switches to another bomb site at the last minute. |
| Eco                    | A strategy where the team saves money by not buying weapons or armor, in order to buy more powerful weapons in future rounds. |
| Force Buy              | A strategy where the team buys weapons and armor even if they do not have enough money, in order to try and win the round. |
| Full Buy               | A strategy where the team buys the best weapons and armor they can afford, in order to have the best chance of winning the round. |
| Save                   | A strategy where the team saves their weapons and armor in order to use them in future rounds. |
| Retake                 | A strategy where the team waits for the enemy team to plant the bomb, and then tries to retake the bomb site. |
| Default                | A strategy where the team spreads out across the map and waits for the enemy team to make a move. |


#### Roles

::: {.callout-note}
This roles are not enforced, but they are a good way to understand the game and the different ways to play it. Even non professional players tend to follow this roles.
:::

In CS2, each player has a specific role to play. There are five main roles in CS2:

- **Entry Fragger:** The player who goes in first and tries to get the first kill.
- **Lurker:** The player who stays behind and tries to catch the enemy team off guard.
- **AWPer:** The player who uses the AWP sniper rifle to get kills from long range.
- **Support:** The player who helps the team by throwing grenades and providing cover fire.
- **In-Game Leader:** The player who calls the shots and makes the decisions for the team.

This roles are chosed individually by each player depending on their own skills and how they play best, and it is important for the team to work together and communicate effectively in order to win the game.

#### Randomness

CS2 is a game of skill, but there is also an element of randomness to it. The outcome of a round can be influenced by many factors, such as the weapons used, the map, the strategy, and the luck of the players. This randomness is what makes CS2 so exciting to watch and play, as it keeps the game fresh and unpredictable.

Each round is virtually unique, completely different from the previous one, and the outcome is never certain. The tide of the game can turn in an instant, and a team that is losing can quickly turn the game around and win the match.

No player faces the same situation twice, and each round is a new challenge that requires quick thinking, fast reflexes, and teamwork to overcome.

#### Final Thoughts

Adding the economic system, the weapons, the grenades, the armor, the maps, the strategies, the roles, and the randomness, CS2 is a complex game that requires a lot of skill and practice to master, but it is also a game that is incredibly rewarding and fun to play.

The final touch is the competitive mode, where players can play against other players of similar skill level, and climb the ranks to become the best player in the world. This mode is what makes CS2 so popular, as it gives players a sense of accomplishment and progression, and keeps them coming back for more.
While in other modes or other games, the player can play for fun but there is no real objective, in competitive mode the player has a goal, to win and climb the ranks, and this is what makes CS2 so addictive and engaging.

</details>


## Data 

```{python libraries}
# loading libraries to read csv files
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import plotly.express as px
from plotly.subplots import make_subplots
from itables import show, options as opt
#opt.maxBytes = 0 # show all data in the table

```

This is a preview of the datasets used in this analysis. 

```{python}
# loading the data
weapons = pd.read_csv('data/weapons_statistics.csv')
top_players = pd.read_csv('data/top_100_players.csv')
maps = pd.read_csv('data/maps_statistics.csv')
pro_players = pd.read_csv('data/csgo_professional_players.csv')
pro_games = pd.read_csv('data/csgo_professional_games.csv')
```

```{python}
# Cleaning the data: removing % and converting to float
# Cleaning Weapons
weapons["HS %"] = weapons["HS %"].str.replace("%", "").astype(float)
weapons["Chest %"] = weapons["Chest %"].str.replace("%", "").astype(float)
weapons["Leg %"] = weapons["Leg %"].str.replace("%", "").astype(float)
weapons["Total Kills"] = weapons["Total Kills"].str.replace(",", "").astype(int)

# Cleaning Maps
maps["T-Win %"] = maps["T-Win %"].str.replace("%", "").astype(float)
maps["CT-Win %"] = maps["CT-Win %"].str.replace("%", "").astype(float)
maps["Play Rate"] = maps["Play Rate"].str.replace("%", "").astype(float)

# Cleaning Pro Players
pro_players["headshot_percentage"] = pro_players["headshot_percentage"].str.replace("%", "").astype(float)
pro_players["team_win_percent_after_first_kill"] = pro_players["team_win_percent_after_first_kill"].str.replace("%", "").astype(float)
pro_players["first_kill_in_won_rounds"] = pro_players["first_kill_in_won_rounds"].str.replace("%", "").astype(float)
```

::: {.panel-tabset}

### Weapons

The weapons_statistics dataset provides insights into weapon performance in CS:GO. Metrics include Kill Per Round (KPR), Headshot Percentage (HS %), Chest %, Leg %, and Total Kills. Weapons like AK-47, M4A1-S, and AWP are analyzed, offering valuable information for strategic gameplay. Weapon Statistics:

```{python}
# Show weapons table
show(weapons)
```

### Players (Normal)

The competitive_players_statistics dataset focuses on individual player performance in competitive CS:GO. Variables include Rank, Name, CS Rating, Region, Wins, Ties, and Losses. Notable players like sH0oRuk YouTube, TTpo100Razeb Daniel, and REZPEZT™ are featured, with their respective performance metrics.

```{python}
# Show Top Normal Players table
show(top_players)
```

### Maps

The maps_statistics dataset offers detailed statistics on various CS:GO maps. Key metrics include Play Rate, T-Win %, CT-Win %, and the total number of Matches. Maps such as Dust II, Mirage, and Inferno are featured, showcasing their popularity and performance metrics.

```{python}
# Show Maps table
show(maps)
```

### Players (Pro)

The csgo_professional_players dataset provides comprehensive statistics on professional CS:GO players. Key metrics include Player ID, Nickname, Real Name, Age, Country, Current Team, Total Kills, Total Deaths, and Headshot Percentage. Notable players like s1mple, ZywOo, and device are featured, with their respective performance metrics.

<details>
<summary> Columns (41) </summary>

| Column | Description   |
|------|------------------------------------|
| `player_id`                        | Player's ID on HLTV                                                |
| `nickname`                         | In-game name of the player                                         |
| `real_name`                        | Name of the player                                                 |
| `age`                              | Age of the player                                                  |
| `country`                          | Country of the player                                              |
| `current_team`                     | Current team of the player                                         |
| `teams`                            | All teams of the player, including previous and current teams      |
| `total_kills`                      | Total in-game kills by the player                                  |
| `total_deaths`                     | Total in-game deaths of the player                                 |
| `headshot_percentage`              | Headshot percentage of the player                                  |
| `damage_per_round`                 | Damage inflicted per round by the player                           |
| `grenade_dmg_per_round`            | Damage inflicted per round with grenade by the player              |
| `maps_played`                      | Total maps played by the player                                    |
| `rounds_played`                    | Total rounds played by the player                                  |
| `kills_per_death`                  | Kill(s) per death ratio of the player                              |
| `kills_per_round`                  | Kill(s) per round ratio of the player                              |
| `assists_per_round`                | Assists per round by the player                                    |
| `deaths_per_round`                 | Deaths per round of the player                                     |
| `saved_teammates_per_round`        | Average number of teammates saved per round by the player          |
| `saved_by_teammate_per_round`      | Average number of times the player was saved by the teammates      |
| `rounds_with_kills`                | Number of rounds in which the player got a kill                    |
| `kill_to_death_diff`               | Kill-death difference                                              |
| `total_opening_kills`              | Total number of opening kills by the player                        |
| `total_opening_deaths`             | Total number of opening deaths of the player                       |
| `opening_kill_ratio`               | Opening kill ratio of the player                                   |
| `opening_kill_rating`              | Opening kill rating of the player                                  |
| `team_win_percent_after_first_kill` | Win percentage of the team after first kill by the player          |
| `first_kill_in_won_rounds`         | Percentage of rounds won in which the player got first kill        |
| `0_kill_rounds`                    | Number of rounds with 0 kills by the player                        |
| `1_kill_rounds`                    | Number of rounds with 1 kill by the player                         |
| `2_kill_rounds`                    | Number of rounds with 2 kills by the player                        |
| `3_kill_rounds`                    | Number of rounds with 3 kills by the player                        |
| `4_kill_rounds`                    | Number of rounds with 4 kills by the player                        |
| `5_kill_rounds`                    | Number of rounds with 5 kills by the player                        |
| `rifle_kills`                      | Number of rifle kills by the player                                |
| `sniper_kills`                     | Number of sniper kills by the player                               |
| `smg_kills`                        | Number of SMG kills by the player                                  |
| `pistol_kills`                     | Number of pistol kills by the player                               |
| `grenade_kills`                    | Number of grenade kills by the player                              |
| `other_kills`                      | Number of other weapon kills by the player                         |
| `rating`                           | Rating of the player with 1.00 being the average                   |

</details>

```{python}
# Show Professional Players table
show(pro_players)
```

### Pro Matches

It is provided crucial information about the teams at the time of the match, such as the winner, team names, match score, head to head past victories and world ranks. Also, there is complete statistics from player1 to player5 of each competing team over a three-month period before the match day. Players are ordered from one to five inside their teams according to their rating(e.g. best rating would be the player1 and worse would be the player5).

<details>
<summary> Columns </summary>

| Feature       | **Description**  |
|----------|-----------------------------|
| `world rank`                 | Team world rank at the match date according to hltv.org rank.                                                                                                      |
| `points`                     | Number of points scored. It can be smaller than 5 if the match was a best of five game, e.g., t1_points = 3 and t2_points = 2, with t1 winning the match.           |
| `h2h win perc`               | Float value from 0 to 1 representing share of wins on past games against the other team. Will be 0.5 if there are no previous confrontations.                       |
| `player1 to player5 features`| Players are ordered from 1 to 5 according to their hltv.org rating (the best-rated player will always be considered player1).                                      |
| `rating`                     | Main metric of player quality.                                                                                                                                     |
| `impact`                     | Overall impact of the player on games (usually correlated with important and decisive kills).                                                                       |
| `kdr`                        | Total number of kills / total number of deaths.                                                                                                                    |
| `dmr`                        | Average damage per round.                                                                                                                                          |
| `kpr`                        | Average number of kills per round.                                                                                                                                 |
| `apr`                        | Average number of assists on teammates' kills per round.                                                                                                           |
| `dpr`                        | Average number of deaths per round.                                                                                                                                |
| `spr`                        | Average number of saved teammates per round.                                                                                                                       |
| `opk ratio`                  | Total opening kills on rounds / total opening deaths on rounds.                                                                                                    |
| `opk rating`                 | HLTV score on the player’s opening kills.                                                                                                                          |
| `wins perc after fk`         | Round conversion rate when the player gets the first kill of the round.                                                                                            |
| `fk perc in wins`            | Percentage of player first kills in won rounds.                                                                                                                    |
| `multikill perc`             | Share of rounds where the player contributed with two or more kills.                                                                                               |
| `rating at least one perc`   | Share of played matches where the player had at least 1.0 rating.                                                                                                  |
| `is sniper`                  | Boolean indicating if the player has the "awp" (sniper) as their first or second weapon with the most kills.                                                       |
| `clutch win perc`            | Conversion rate for the player in one vs. one situations.                                                                                                          |


</details>

```{python}
# Show Professional Matches table
show(pro_games)
```
:::

## Analysis

### Weapons Analysis

#### Total Kills by Weapon

```{python}
#total kills by weapon
fig = px.bar(weapons.sort_values(by='Total Kills', ascending=False), x='Weapon', y='Total Kills', title='Total Kills by Weapon', color='Weapon')
fig.show()
```

The bar chart above shows the total kills by weapon. The AK-47 and M4A1-S are the most popular weapons, with the AWP and M4A1 being the next most popular. 
AK-47 is the most popular weapon, doubling the second most popular weapon, the M4A1-S.

::: {.callout-note}
Weapon selection in CS2 are slightly different from Terrorist to Counter Terrorist. 

Weapons like AK-47, Glock-18 or SG 553 are T only, while M4A1-S, AUG or USP-S are CT only
:::

This means that for AK-47 to have so many kills, knowing that in a match half of the players are CT and half T, even the CT will pick up and use an AK-47 and use it if the have the chance, making it the most popular weapon on the game.


#### KPR (Kills per Round) by Weapon

```{python}
# KPR (Kills Per Round) by weapon
fig = px.bar(weapons.sort_values(by='KPR', ascending=False), x='Weapon', y='KPR', title='Kills Per Round (KPR) by Weapon', color='Weapon')
fig.show()
```

The figure above shows the average kills per round with each weapon. Here we can already start to think about **effectiveness** of a weapon (in the hands of the correct player). 

In average, a player with a G3SG1 will kill 1.9 enemies, with AWP 1.6, AUG 1.3 and AK-47 1.2. This decimal numbers can be described as percentage of health of an enemy, so 1.9 is one kill and 90% of health of another player (or distributed among other players).

::: {.callout-note}
The first 2 weapons are sniper rifles and the third has a scope, so they are used for long range kills. The AK-47 is a rifle, used for medium range kills.
:::

#### Accuracy by Weapon

On the next chart we can see the accuracy of each weapon. Here "*accuracy*" is the sum of the percentage of headshots, chest shots and leg shots. (Ordered Descending)

```{python}
# stacked bar chart with HS %, Chest % and Leg % using plotly Y = weapons
fig = px.bar(weapons, x='Weapon', y=['HS %', 'Chest %', 'Leg %'], title='Headshot, Chest and Leg Percentage by Weapon', barmode='stack')
fig.update_layout(barmode='stack', xaxis={'categoryorder':'total descending'})
fig.show()
```

We can see that **accuracy** totals around 90% for all weapons, but when we look at the individual parts, these are not distributed equally. 

- **Headshots:** Desert Eagle is the weapon with the highest headshot percentage, followed by USP-S and Famas. USP-S is a CT only weapon and it is given at the start of the round, so most CT players have it most of the time.
Desert Eagle, on the other hand, is the most expensive pistol in the game, so it is used by players that are confident in their aim. 

- **Chest:**Numbers are more evenly distributed around 60%, nevertheless, the AWP has the highest percentage, followed by 5 pistols. AWP is because is a one hit kill weapon, so players aim for the chest to guarantee the kill. For the pistols, they are used in close range where enemies are moving, so it is harder to aim for the head.

- **Leg:** Numbers are similar to Headshots. Here we can see that the weapons with the highest leg percentage are SMGs and shotguns. These weapons are used in close range, where it is easier to hit the legs of the enemy. Also the spray pattern of these weapons is more random, so they tend to be aimed lower.

### Maps Analysis


::: {.callout-note}
### Anotation 2
Note that there are five types of callouts, including:
`note`, `warning`, `important`, `tip`, and `caution`.
```{markdown}
::: {.callout-caution collapse="true"}
## Expand To Learn About Collapse

This is an example of a 'folded' caution callout that can be expanded by the user. You can use `collapse="true"` to collapse it by default or `collapse="false"` to make a collapsible callout that is expanded by default.
:::
```
:::
